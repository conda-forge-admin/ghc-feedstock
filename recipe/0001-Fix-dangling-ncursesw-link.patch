From efac1adb731cf4a187a3281afa9b1729b22a1298 Mon Sep 17 00:00:00 2001
From: "Uwe L. Korn" <uwe.korn@quantco.com>
Date: Wed, 12 May 2021 16:26:04 +0200
Subject: [PATCH] Fix dangling ncursesw link

---
 ghc.mk | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/ghc.mk b/ghc.mk
index 2481001..f94aaef 100644
--- a/ghc.mk
+++ b/ghc.mk
@@ -983,6 +983,9 @@ install_packages: rts/dist/package.conf.install
 	                                  '$(ghclibdir)'              \
 	                                  '$(docdir)/html/libraries'  \
 	                                  '$(GhcLibWays)'))
+	install_name_tool -change /nix/store/wxx8sfsa5x1753r8d1x8dx2927qncwbw-ncurses-6.2/lib/libncursesw.6.dylib ${BUILD_PREFIX}/lib/libncursesw.6.dylib ${BUILD_PREFIX}/lib/ghc-9.2.0.20210422/terminfo-0.4.1.4/libHSterminfo-0.4.1.4-ghc9.2.0.20210422.dylib
+	install_name_tool -change /nix/store/wxx8sfsa5x1753r8d1x8dx2927qncwbw-ncurses-6.2/lib/libncursesw.6.dylib ${BUILD_PREFIX}/lib/libncursesw.6.dylib ${BUILD_PREFIX}/lib/ghc-9.2.0.20210422/haskeline-0.8.1.0/libHShaskeline-0.8.1.0-ghc9.2.0.20210422.dylib
+	install_name_tool -change /nix/store/wxx8sfsa5x1753r8d1x8dx2927qncwbw-ncurses-6.2/lib/libncursesw.6.dylib ${BUILD_PREFIX}/lib/libncursesw.6.dylib ${BUILD_PREFIX}/lib/ghc-9.2.0.20210422/ghc-9.2.0.20210422/libHSghc-9.2.0.20210422-ghc9.2.0.20210422.dylib
 	"$(INSTALLED_GHC_PKG_REAL)" --force --global-package-db "$(INSTALLED_PACKAGE_CONF)" update rts/dist/package.conf.install
 	$(foreach p, $(INSTALL_PACKAGES),                             \
 	    $(call make-command,                                      \
-- 
2.30.1 (Apple Git-130)

